# TikTok 自动化系统 - 需求分析与规划

## 项目概述

**项目名称**：TikTok Video Auto Publisher  
**项目目标**：构建一个 TikTok 视频自动发布系统

### 核心能力
- 自动登录 TikTok 账号（通过浏览器用户数据或 Cookie）
- 自动上传并发布视频文件
- 支持在 Docker 容器中以无头浏览器模式运行

---

## 核心功能（MVP 范围）

| 功能模块 | 描述 | 优先级 |
|---------|------|--------|
| **登录模块** | 支持通过 Chrome 用户数据目录或 Cookie 文件自动登录 | P0 |
| **视频上传** | 选择本地视频文件并上传到 TikTok | P0 |
| **发布配置** | 设置视频标题、描述、标签（hashtags） | P0 |
| **发布执行** | 自动点击发布按钮完成发布 | P0 |
| **Docker 支持** | 在 Docker 中以 headless 模式运行 | P1 |
| **日志记录** | 记录操作日志，便于调试 | P1 |
| **错误处理** | 处理网络超时、元素未找到等异常 | P1 |

---

## 技术选型

| 类别 | 技术方案 | 理由 |
|-----|---------|------|
| **编程语言** | Python 3.10+ | 生态丰富，Selenium 支持好 |
| **自动化框架** | Selenium + undetected-chromedriver | 绑过基本的反爬检测 |
| **浏览器** | Chrome/Chromium | 最稳定，Docker 支持好 |
| **容器化** | Docker + docker-compose | 便于部署和环境一致性 |
| **配置管理** | Python dotenv / YAML | 灵活管理配置参数 |

---

## 项目结构设计

```
MiniTiktokAutomationSystem/
├── src/
│   ├── __init__.py
│   ├── main.py              # 程序入口
│   ├── browser.py           # 浏览器初始化和管理
│   ├── login.py             # 登录逻辑
│   ├── uploader.py          # 视频上传逻辑
│   └── utils.py             # 工具函数
├── config/
│   └── config.yaml          # 配置文件
├── data/
│   ├── cookies/             # Cookie 存储
│   └── videos/              # 待上传视频
├── logs/                    # 日志目录
├── docker/
│   ├── Dockerfile
│   └── docker-compose.yml
├── requirements.txt         # Python 依赖
├── .env.example             # 环境变量模板
├── .gitignore
└── README.md
```

---

## 关键技术挑战与解决方案

| 挑战 | 解决方案 |
|-----|---------|
| **TikTok 反爬检测** | 使用 `undetected-chromedriver`，模拟真实用户行为（随机延迟、鼠标移动） |
| **登录状态保持** | 复用 Chrome 用户数据目录（`--user-data-dir`）或导出/导入 Cookie |
| **Headless 模式限制** | 配置正确的 user-agent 和窗口大小，避免被识别为机器人 |
| **视频上传慢** | 添加显式等待（WebDriverWait），处理大文件上传超时 |
| **Docker 中运行 Chrome** | 使用 `selenium/standalone-chrome` 官方镜像或自建镜像 |

---

## 工作流程图

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  初始化浏览器 │ ──▶ │  加载登录态  │ ──▶ │  打开上传页  │ ──▶ │  选择视频   │
└─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
                                                                   │
                                                                   ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  关闭浏览器  │ ◀── │  确认发布成功 │ ◀── │  点击发布   │ ◀── │  填写信息   │
└─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
```

---

## 依赖清单

```
selenium>=4.15.0
undetected-chromedriver>=3.5.0
webdriver-manager>=4.0.0
python-dotenv>=1.0.0
pyyaml>=6.0
loguru>=0.7.0
```

---

## 下一步

- [ ] 第二步：环境搭建 - 创建项目目录结构、初始化依赖
- [ ] 第三步：实现浏览器初始化模块
- [ ] 第四步：实现登录模块
- [ ] 第五步：实现视频上传模块
- [ ] 第六步：Docker 容器化
- [ ] 第七步：测试与优化
