# TikTok 自动化系统 - 环境搭建

## 已创建的项目结构

```
tiktokAuto/
├── src/                          # 源代码目录
│   ├── __init__.py               # 包初始化
│   ├── main.py                   # 程序入口
│   ├── browser.py                # 浏览器管理模块
│   ├── login.py                  # 登录模块
│   ├── uploader.py               # 视频上传模块
│   └── utils.py                  # 工具函数
├── config/
│   └── config.yaml               # 配置文件
├── data/
│   ├── videos/                   # 待上传视频目录
│   │   └── .gitkeep
│   └── cookies/                  # Cookie 存储目录
│       └── .gitkeep
├── logs/                         # 日志目录
│   └── .gitkeep
├── docker/
│   ├── Dockerfile                # Docker 镜像配置
│   └── docker-compose.yml        # Docker Compose 配置
├── docs/
│   ├── 01-需求分析与规划.md
│   └── 02-环境搭建.md
├── requirements.txt              # Python 依赖
├── .gitignore                    # Git 忽略规则
└── README.md                     # 项目说明
```

---

## 依赖说明

### requirements.txt

| 包名 | 版本 | 用途 |
|-----|------|-----|
| selenium | >=4.15.0 | Web 自动化核心框架 |
| undetected-chromedriver | >=3.5.0 | 反检测 Chrome 驱动 |
| webdriver-manager | >=4.0.0 | 自动管理 WebDriver |
| python-dotenv | >=1.0.0 | 环境变量管理 |
| pyyaml | >=6.0 | YAML 配置解析 |
| loguru | >=0.7.0 | 日志记录 |
| requests | >=2.31.0 | HTTP 请求工具 |

---

## 配置文件说明

### config/config.yaml

```yaml
# 浏览器设置
browser:
  headless: false           # 是否无头模式
  window_size:
    width: 1920
    height: 1080
  implicit_wait: 10         # 隐式等待时间(秒)
  page_load_timeout: 60     # 页面加载超时(秒)

# TikTok 相关 URL
tiktok:
  base_url: "https://www.tiktok.com"
  upload_url: "https://www.tiktok.com/creator-center/upload"
  login_url: "https://www.tiktok.com/login"

# 上传设置
upload:
  max_title_length: 150     # 标题最大长度
  max_retries: 3            # 最大重试次数
  upload_timeout: 300       # 上传超时(秒)

# 时间延迟(模拟人类行为)
timing:
  min_delay: 1              # 最小延迟(秒)
  max_delay: 3              # 最大延迟(秒)
  typing_delay: 0.05        # 打字延迟(秒)
```

---

## 模块说明

### 1. main.py - 程序入口
- 解析命令行参数
- 加载配置文件
- 协调各模块执行上传任务

### 2. browser.py - 浏览器管理
- 初始化 Chrome 浏览器（使用 undetected-chromedriver）
- 配置反检测选项
- 管理浏览器生命周期

### 3. login.py - 登录管理
- 检测登录状态
- 加载/保存 Cookies
- 支持手动登录

### 4. uploader.py - 视频上传
- 导航到上传页面
- 上传视频文件
- 填写标题和标签
- 点击发布按钮

### 5. utils.py - 工具函数
- 配置文件加载
- 日志设置
- 视频文件验证

---

## 环境安装步骤

### 本地开发环境

```bash
# 1. 创建虚拟环境
python -m venv venv

# 2. 激活虚拟环境
# macOS/Linux:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# 3. 安装依赖
pip install -r requirements.txt

# 4. 复制环境变量模板(手动创建 .env 文件)
# 在项目根目录创建 .env 文件，内容如下：
# CHROME_USER_DATA_DIR=./chrome_data
# HEADLESS_MODE=false
# LOG_LEVEL=INFO
```

### Docker 环境

```bash
# 构建镜像
cd docker
docker-compose build

# 运行容器
docker-compose up
```

---

## 下一步

- [ ] 第三步：测试浏览器初始化
- [ ] 第四步：测试登录功能
- [ ] 第五步：测试视频上传功能
- [ ] 第六步：Docker 部署测试
